<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta property="og:title" content="Chinh Ph·ª•c S·ªë Nguy√™n - To√°n 6">
    <meta property="og:description" content="Tr√≤ ch∆°i √¥n t·∫≠p to√°n h·ªçc th√∫ v·ªã d√†nh cho h·ªçc sinh l·ªõp 6.">
    <meta property="og:image" content="https://i.imgur.com/8Q5kKkE.png"> <title>Chinh Ph·ª•c S·ªë Nguy√™n - Pro Version</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* --- CSS VARIABLES --- */
        :root {
            --primary: #FF6B6B; 
            --secondary: #4ECDC4; 
            --accent: #FFE66D; 
            --dark: #292f36;
            --light: #f7fff7;
            --bar-bg: #e0e0e0;
            --success: #2ecc71;
            --error: #e74c3c;
        }

        /* --- GLOBAL STYLES --- */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--secondary);
            background-image: linear-gradient(135deg, #4ECDC4 0%, #556270 100%);
            margin: 0;
            color: var(--dark);
            min-height: 100vh;
        }

        /* --- HEADER --- */
        header {
            background-color: white;
            padding: 20px;
            text-align: center;
            border-bottom: 5px solid var(--primary);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            position: relative;
            border-radius: 0 0 30px 30px;
            z-index: 10;
        }

        h1 {
            font-family: 'Patrick Hand', cursive;
            font-size: 2.5rem;
            margin: 0;
            color: var(--primary);
            text-shadow: 2px 2px var(--accent);
        }

        .score-board {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--accent);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            border: 2px solid var(--dark);
            box-shadow: 3px 3px 0px var(--dark);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* N√∫t Reset Game (M·ªõi) */
        .btn-reset {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            color: var(--dark);
            padding: 0 5px;
            opacity: 0.5;
            transition: opacity 0.3s;
        }
        .btn-reset:hover { opacity: 1; color: var(--error); }

        /* --- LAYOUT CONTAINER --- */
        .container {
            max-width: 900px;
            margin: 30px auto;
            padding: 0 15px;
            padding-bottom: 50px;
        }

        .section-title {
            font-family: 'Patrick Hand', cursive;
            color: white;
            font-size: 2.5rem;
            text-shadow: 2px 2px #000;
            margin-bottom: 20px;
            text-align: center;
            margin-top: 50px;
        }

        /* --- CARDS --- */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }

        .card h3 {
            color: var(--secondary);
            border-bottom: 2px dashed #ddd;
            padding-bottom: 10px;
            margin-top: 0;
        }

        .concept-box {
            background: #f0f8ff;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border-left: 5px solid var(--primary);
        }

        .fun-fact {
            background: #fff9c4;
            border: 2px dashed var(--primary);
        }
        .fun-fact img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-top: 15px;
            border: 1px solid #ddd;
        }

        /* --- GAME AREA (N√¢ng c·∫•p giao di·ªán) --- */
        .game-area {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 4px solid var(--light);
        }

        /* HUD (Heads-Up Display) */
        .game-hud {
            display: flex; 
            justify-content: space-between; 
            align-items: flex-end; 
            margin-bottom: 5px; 
            font-weight: bold; 
            font-size: 0.9rem; 
            color: #777;
        }

        .current-score {
            color: var(--primary); 
            font-size: 1.5rem; 
            transform: translateY(2px);
            background: #ffe66d33;
            padding: 2px 10px;
            border-radius: 10px;
        }

        .progress-container {
            width: 100%;
            background-color: var(--bar-bg);
            border-radius: 10px;
            margin-bottom: 20px;
            height: 12px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--secondary);
            border-radius: 10px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .question-box {
            font-size: 1.6rem;
            margin: 30px 0;
            font-weight: bold;
            min-height: 60px;
            line-height: 1.4;
        }
        
        .quiz-img {
            max-width: 100%;
            max-height: 250px;
            border-radius: 10px;
            margin: 10px auto;
            display: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            object-fit: contain;
        }

        /* Controls */
        .input-group {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        input[type="number"] {
            font-size: 1.8rem;
            padding: 10px;
            width: 140px;
            text-align: center;
            border: 3px solid #ddd;
            border-radius: 12px;
            outline: none;
            transition: border-color 0.2s;
        }
        input[type="number"]:focus { border-color: var(--secondary); }

        .btn-sign {
            background-color: var(--dark);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 12px;
            font-size: 1.4rem;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 0 #000;
            transition: transform 0.1s;
        }
        .btn-sign:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        .btn-check {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.4rem;
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Patrick Hand', cursive;
            box-shadow: 0 5px 0 #c0392b;
            transition: all 0.1s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-check:hover { filter: brightness(1.1); }
        .btn-check:active { transform: translateY(5px); box-shadow: 0 0 0 #c0392b; }

        .feedback {
            margin-top: 20px;
            font-size: 1.3rem;
            font-weight: bold;
            min-height: 40px;
            padding: 10px;
            border-radius: 8px;
        }

        /* Animation Classes */
        .shake { animation: shake 0.5s; }
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }

        .pop-in { animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        footer {
            text-align: center;
            color: white;
            padding: 20px;
            margin-top: 50px;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        @media (max-width: 600px) {
            h1 { font-size: 2rem; }
            .score-board { position: static; display: flex; justify-content: center; margin-top: 10px; }
            .btn-check { width: 100%; }
            .game-area { padding: 20px; }
        }
    </style>
</head>
<body>

    <audio id="sound-correct" src="https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg"></audio>
    <audio id="sound-wrong" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
    <audio id="sound-win" src="https://actions.google.com/sounds/v1/cartoon/tympani_bing.ogg"></audio>

    <header>
        <h1>üöÄ Chinh Ph·ª•c S·ªë Nguy√™n</h1>
        <div class="score-board">
            ‚≠ê <span id="header-score">0</span> XP
            <button class="btn-reset" onclick="resetGame()" title="Ch∆°i l·∫°i t·ª´ ƒë·∫ßu">‚Ü∫</button>
        </div>
        <p>Phi√™n b·∫£n Pro 2.0 - T·ª± ƒë·ªông l∆∞u game</p>
    </header>

    <div class="container">
        
        <h2 class="section-title">üìú B√≠ K√≠p Nh·∫≠p M√¥n</h2>
        <div class="card-grid">
            <div class="card">
                <h3>1. C·ªông hai phe ƒë·ªëi ngh·ªãch</h3>
                <div class="concept-box">
                    <p><strong>Chi·∫øn thu·∫≠t:</strong> T√¨m xem phe n√†o m·∫°nh h∆°n?</p>
                    <ul>
                        <li>L·∫•y s·ªë l·ªõn tr·ª´ s·ªë b√© (gi√° tr·ªã tuy·ªát ƒë·ªëi).</li>
                        <li>K·∫øt qu·∫£ mang d·∫•u c·ªßa "phe m·∫°nh h∆°n".</li>
                    </ul>
                </div>
                <p>V√≠ d·ª•: \( (+2) + (-6) \)</p>
                <p>Phe √¢m (-6) th·∫Øng phe d∆∞∆°ng (+2). <br> -> K·∫øt qu·∫£: \( -(6-2) = -4 \).</p>
            </div>

            <div class="card">
                <h3>2. Ph√©p tr·ª´ "Bi·∫øn h√¨nh"</h3>
                <div class="concept-box">
                    <p>Ph√©p tr·ª´ l√† ph√©p c·ªông v·ªõi s·ªë ƒë·ªëi!</p>
                    $$ a - b = a + (-b) $$
                </div>
                <p>V√≠ d·ª•: \( 2 - 5 \)</p>
                <p>Bi·∫øn h√¨nh: \( 2 + (-5) = -3 \)</p>
            </div>

            <div class="card">
                <h3>3. Ph√° v·ª° l·ªìng giam (D·∫•u ngo·∫∑c)</h3>
                <div class="concept-box">
                    <p><strong>Quy t·∫Øc ph√° ng·ª•c:</strong></p>
                    <ul>
                        <li>Tr∆∞·ªõc ngo·∫∑c l√† <strong>(+)</strong>: Gi·ªØ nguy√™n t·∫•t c·∫£.</li>
                        <li>Tr∆∞·ªõc ngo·∫∑c l√† <strong>(-)</strong>: <strong>ƒê·ªïi d·∫•u</strong> t·∫•t c·∫£ b√™n trong.</li>
                    </ul>
                </div>
                <p>V√≠ d·ª•: \( -(a - b) = -a + b \)</p>
            </div>
        </div>

        <h2 class="section-title">üåç Th·∫ø Gi·ªõi Quanh Ta</h2>
        <div class="card-grid">
            <div class="card fun-fact">
                <h3>üêü Chuy·ªán ch√∫ C√° Chu·ªìn</h3>
                <p>·ªû ƒë·ªô s√¢u <strong>-2m</strong>, bay l√™n <strong>3m</strong> (+3).</p>
                <p><strong>Ph√©p t√≠nh:</strong> \( (-2) + 3 = 1 \) (m√©t)</p>
                <p><em>K·∫øt lu·∫≠n: Bay cao h∆°n m·∫∑t n∆∞·ªõc 1m!</em></p>
                <img src="https://tepbac.com/upload/images/2024/04/ca-chuon-1_1712200867.jpg" alt="C√° chu·ªìn">
            </div>

            <div class="card fun-fact">
                <h3>üèõÔ∏è Nh√† b√°c h·ªçc Archimedes</h3>
                <p>Sinh nƒÉm <strong>-287</strong>, m·∫•t nƒÉm <strong>-212</strong>.</p>
                <p><strong>Tu·ªïi th·ªç:</strong> \( (-212) - (-287) = 75 \)</p>
                <p><em>K·∫øt lu·∫≠n: √îng th·ªç 75 tu·ªïi.</em></p>
                <img src="https://images.immediate.co.uk/production/volatile/sites/7/2023/12/Illustration-of-archimedes-53d0769-e1701949287191.jpg" alt="Archimedes">
            </div>
        </div>

        <h2 class="section-title">üéÆ ƒê·∫•u Tr∆∞·ªùng To√°n H·ªçc</h2>
        <div class="game-area">
            
            <div class="game-hud">
                <span>Ti·∫øn ƒë·ªô</span>
                <span class="current-score">
                    üèÜ <span id="game-score">0</span>
                </span>
                <span id="progress-text">0%</span>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>

            <div id="quiz-container">
                <img id="quiz-img" class="quiz-img" src="" alt="H√¨nh minh h·ªça">

                <div class="question-box pop-in" id="question-text">
                    ƒêang t·∫£i d·ªØ li·ªáu...
                </div>
                
                <div class="input-group">
                    <button class="btn-sign" onclick="toggleSign()" title="ƒê·ªïi d·∫•u √¢m/d∆∞∆°ng">+/-</button>
                    <input type="number" id="user-answer" placeholder="?" autocomplete="off">
                </div>
                
                <button class="btn-check" onclick="checkAnswer()">TR·∫¢ L·ªúI</button>
                
                <div id="feedback-msg" class="feedback"></div>
            </div>
        </div>

    </div>

    <footer>
        <p>Design by Gemini & You | Maths Grade 6</p>
    </footer>

    <script>
        // D·ªØ li·ªáu c√¢u h·ªèi g·ªëc
        const rawQuestions = [
            { text: "T√≠nh: \\( (-4) + (-7) \\)", answer: -11, note: "C√πng d·∫•u √¢m th√¨ c·ªông l·∫°i r·ªìi ƒë·∫∑t d·∫•u (-) nh√©!", img: "" },
            { text: "T√≠nh: \\( 4 + (-7) \\)", answer: -3, note: "S·ªë √¢m (-7) m·∫°nh h∆°n s·ªë d∆∞∆°ng (4) => K·∫øt qu·∫£ √¢m.", img: "" },
            { text: "T√≠nh: \\( 23 - (-12) \\)", answer: 35, note: "Tr·ª´ c·ªßa tr·ª´ th√†nh c·ªông: 23 + 12 = 35.", img: "" },
            { text: "T√≠nh: \\( (-5) + 12 \\)", answer: 7, note: "S·ªë d∆∞∆°ng 12 l·ªõn h∆°n s·ªë ƒë·ªëi c·ªßa -5.", img: "" },
            { text: "T√≠nh: \\( (-25) + 72 \\)", answer: 47, note: "L·∫•y 72 tr·ª´ 25 = 47.", img: "" },
            { text: "Nhi·ªát ƒë·ªô ph√≤ng l·∫°nh l√† 2¬∞C. B√°c th·ª£ gi·∫£m ƒëi 5¬∞C. Nhi·ªát ƒë·ªô m·ªõi l√† bao nhi√™u?", answer: -3, note: "Ph√©p t√≠nh: 2 - 5 = -3.", img: "https://images.unsplash.com/photo-1564313337446-48c0350d75f2?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80" },
            { text: "B√°c Lan cho n·ª£ 80k, sau ƒë√≥ cho n·ª£ th√™m 40k. T·ªïng n·ª£ l√† bao nhi√™u (bi·ªÉu di·ªÖn s·ªë √¢m)?", answer: -120, note: "-80 + (-40) = -120.", img: "" },
            { text: "T√†u ng·∫ßm ƒëang ·ªü ƒë·ªô s√¢u -20m, n√≥ l·∫∑n xu·ªëng th√™m 15m n·ªØa. H·ªèi ƒë·ªô s√¢u m·ªõi?", answer: -35, note: "-20 + (-15) = -35.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/160826-N-WI365-108_%2829323499386%29.jpg/640px-160826-N-WI365-108_%2829323499386%29.jpg" },
            { text: "Thang m√°y ƒëang ·ªü t·∫ßng 3, ƒëi L√äN 5 t·∫ßng. N√≥ d·ª´ng ·ªü t·∫ßng m·∫•y?", answer: 8, note: "3 + 5 = 8.", img: "" },
            { text: "V·∫´n chi·∫øc thang m√°y ƒë√≥ ·ªü t·∫ßng 3, gi·ªù ƒëi XU·ªêNG 5 t·∫ßng. N√≥ d·ª´ng ·ªü t·∫ßng s·ªë m·∫•y? (T·∫ßng h·∫ßm l√† s·ªë √¢m)", answer: -2, note: "3 - 5 = -2.", img: "" },
            { text: "Archimedes sinh nƒÉm -287, m·∫•t nƒÉm -212. √îng h∆∞·ªüng th·ªç bao nhi√™u tu·ªïi?", answer: 75, note: "(-212) - (-287) = 75.", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/2/27/Archimedes_by_Fetti.jpg/300px-Archimedes_by_Fetti.jpg" }
        ];

        let questions = [];
        let currentQIndex = 0;
        let score = 0;

        // --- C√ÅC H√ÄM H·ªñ TR·ª¢ ---

        function playSound(type) {
            // type: 'correct', 'wrong', 'win'
            const audio = document.getElementById('sound-' + type);
            if (audio) {
                audio.currentTime = 0; // Tua v·ªÅ ƒë·∫ßu
                audio.play().catch(e => console.log("Tr√¨nh duy·ªát ch·∫∑n t·ª± ph√°t √¢m thanh:", e));
            }
        }

        function fireConfetti() {
            // Hi·ªáu ·ª©ng ph√°o hoa t·ª´ th∆∞ vi·ªán canvas-confetti
            var count = 200;
            var defaults = { origin: { y: 0.7 } };

            function fire(particleRatio, opts) {
                confetti(Object.assign({}, defaults, opts, {
                    particleCount: Math.floor(count * particleRatio)
                }));
            }

            fire(0.25, { spread: 26, startVelocity: 55, });
            fire(0.2, { spread: 60, });
            fire(0.35, { spread: 100, decay: 0.91, scalar: 0.8 });
            fire(0.1, { spread: 120, startVelocity: 25, decay: 0.92, scalar: 1.2 });
            fire(0.1, { spread: 120, startVelocity: 45, });
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- LOCAL STORAGE: L∆ØU GAME ---
        function saveData() {
            const data = {
                score: score,
                currentQIndex: currentQIndex,
                questions: questions // L∆∞u th·ª© t·ª± c√¢u h·ªèi ƒë√£ x√°o tr·ªôn
            };
            localStorage.setItem('mathGameData', JSON.stringify(data));
        }

        function loadData() {
            const data = localStorage.getItem('mathGameData');
            if (data) {
                const parsed = JSON.parse(data);
                score = parsed.score;
                currentQIndex = parsed.currentQIndex;
                questions = parsed.questions;
                return true; // C√≥ d·ªØ li·ªáu c≈©
            }
            return false; // Ch∆∞a c√≥ d·ªØ li·ªáu
        }

        function resetGame() {
            if(confirm("B·∫°n c√≥ ch·∫Øc mu·ªën ch∆°i l·∫°i t·ª´ ƒë·∫ßu? ƒêi·ªÉm s·ªë s·∫Ω v·ªÅ 0.")) {
                localStorage.removeItem('mathGameData');
                location.reload();
            }
        }

        // --- LOGIC GAME CH√çNH ---

        function toggleSign() {
            const input = document.getElementById('user-answer');
            let val = input.value;
            if (val === "") input.value = "-"; 
            else if (val === "-") input.value = ""; 
            else input.value = parseInt(val) * -1;
            input.focus();
        }

        function updateProgress() {
            const percent = Math.round((currentQIndex / questions.length) * 100);
            document.getElementById('progress-bar').style.width = percent + "%";
            document.getElementById('progress-text').innerText = percent + "%";
            
            // Update Score UI
            document.getElementById('header-score').innerText = score;
            document.getElementById('game-score').innerText = score;
        }

        function loadQuestion() {
            updateProgress();
            
            // Ki·ªÉm tra n·∫øu ƒë√£ h·∫øt c√¢u h·ªèi
            if (currentQIndex >= questions.length) {
                showFinishScreen();
                return;
            }

            const q = questions[currentQIndex];
            
            // Animation ch·ªØ
            const qTextElement = document.getElementById('question-text');
            qTextElement.classList.remove('pop-in');
            void qTextElement.offsetWidth; // Trigger reflow
            qTextElement.classList.add('pop-in');

            qTextElement.innerHTML = "C√¢u " + (currentQIndex + 1) + ": " + q.text;
            
            // Reset inputs
            const inputEl = document.getElementById('user-answer');
            inputEl.value = '';
            inputEl.disabled = false;
            inputEl.focus();
            
            document.getElementById('feedback-msg').innerHTML = '';
            document.querySelector('.btn-check').style.display = 'inline-block';

            // X·ª≠ l√Ω ·∫£nh
            const imgEl = document.getElementById('quiz-img');
            if(q.img && q.img !== "") {
                imgEl.src = q.img;
                imgEl.style.display = "block";
            } else {
                imgEl.style.display = "none";
            }

            // MathJax render
            if (window.MathJax) {
                MathJax.typesetPromise().catch((err) => console.log('MathJax error:', err));
            }
        }

        function showFinishScreen() {
            document.getElementById('progress-bar').style.width = "100%";
            document.getElementById('progress-text').innerText = "100%";
            playSound('win');
            fireConfetti(); // B·∫Øn ph√°o hoa

            const gameArea = document.querySelector('.game-area');
            gameArea.innerHTML = `
                <div class="pop-in">
                    <h2 style="color: var(--primary); font-size: 2.5rem; margin-bottom: 10px;">üèÜ XU·∫§T S·∫ÆC!</h2>
                    <p>B·∫°n ƒë√£ ho√†n th√†nh t·∫•t c·∫£ c√¢u h·ªèi.</p>
                    <div style="font-size: 3rem; margin: 20px 0;">üíé ${score} XP</div>
                    <button class="btn-check" onclick="resetGame()">Ch∆°i l·∫°i t·ª´ ƒë·∫ßu</button>
                </div>
            `;
            // X√≥a save game khi ho√†n th√†nh
            localStorage.removeItem('mathGameData');
        }

        function checkAnswer() {
            const inputEl = document.getElementById('user-answer');
            const userVal = parseInt(inputEl.value);
            const currentQ = questions[currentQIndex];
            const feedback = document.getElementById('feedback-msg');
            const gameArea = document.querySelector('.game-area');

            if (isNaN(userVal)) {
                feedback.innerHTML = "‚ö†Ô∏è H√£y nh·∫≠p m·ªôt con s·ªë!";
                feedback.style.color = "#e67e22";
                return;
            }

            if (userVal === currentQ.answer) {
                // ƒê√öNG
                score += 100;
                playSound('correct');
                feedback.innerHTML = `
                    <div style="background: #d4edda; color: #155724; padding: 10px; border-radius: 8px;">
                        üéâ Ch√≠nh x√°c! <br> ${currentQ.note}
                    </div>`;
                
                // Hi·ªáu ·ª©ng nh·∫π khi ƒë√∫ng
                confetti({ particleCount: 50, spread: 50, origin: { y: 0.8 } });

                inputEl.disabled = true; // Kh√≥a input ƒë·ªÉ kh√¥ng s·ª≠a
                document.querySelector('.btn-check').style.display = 'none'; // ·∫®n n√∫t

                // TƒÉng index v√† L∆∞u game
                currentQIndex++;
                saveData(); 
                updateProgress(); // C·∫≠p nh·∫≠t ƒëi·ªÉm ngay l·∫≠p t·ª©c

                // Chuy·ªÉn c√¢u sau 2s
                setTimeout(() => {
                    loadQuestion();
                }, 2000);

            } else {
                // SAI
                playSound('wrong');
                feedback.innerHTML = "üí• Sai r·ªìi, th·ª≠ t√≠nh l·∫°i xem!";
                feedback.style.color = "var(--error)";
                gameArea.classList.add('shake');
                setTimeout(() => { gameArea.classList.remove('shake'); }, 500);
                inputEl.focus();
            }
        }

        // --- INIT GAME ---
        // X·ª≠ l√Ω ph√≠m Enter
        document.getElementById('user-answer').addEventListener("keypress", function(event) {
            if (event.key === "Enter") checkAnswer();
        });

        // Ki·ªÉm tra xem c√≥ d·ªØ li·ªáu c≈© kh√¥ng
        if (!loadData()) {
            // N·∫øu kh√¥ng c√≥ d·ªØ li·ªáu c≈©, t·∫°o m·ªõi
            questions = shuffleArray([...rawQuestions]);
        }

        // B·∫Øt ƒë·∫ßu
        loadQuestion(); 

    </script>
</body>
</html>
